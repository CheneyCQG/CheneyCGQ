<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Test - My New Hugo Site</title><meta name="Description" content="This is my cool site"><meta property="og:title" content="Test" />
<meta property="og:description" content="回顾 1. springboot概述 主要作用就是帮我们快速的构建庞大的JavaEE项目 特点： 版本锁定 起步依赖 自动配置 2. 搭建springboot项目 pom.xml 继承parent 导入xxx起步依赖（集合体） 启动类 @SpringBootApplication 配置文件 application.yml 3. yml配置文件 语法：严格区分大小写，使用缩进表示层级关系，属性值之前（冒号之间）必须有空格 格式： 普通类型 对象类型 集合类型	读取配置文件： @Value Enviroment @ConfigurationProperties 4. springboot整合其它框架 springboot &#43; springMVC &#43; mybatisPlus &#43; JSP等 一 SpringBoot 整合其它框架 1.0 整合FreeMark【掌握】 1.0.1 POM &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-freemarker&lt;/artifactId&gt; &lt;/dependency&gt; 1.0.2 启动类以及Controller三层 @SpringBootApplication public class SpringbootAllApplication { public static void main(String[] args) { SpringApplication.run(SpringbootAllApplication.class, args); } } 1.0.3 视图解析配置 spring.freemarker.template-loader-path=classpath:/templates/ spring.freemarker.suffix=.ftlh 1.0.4 页面 &lt;!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://cheneycqg.github.io/posts/springboot%E8%BF%9B%E9%98%B6%E7%AF%87/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-29T17:40:19+08:00" />
<meta property="article:modified_time" content="2023-07-29T17:40:19+08:00" /><meta property="og:site_name" content="My cool site" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Test"/>
<meta name="twitter:description" content="回顾 1. springboot概述 主要作用就是帮我们快速的构建庞大的JavaEE项目 特点： 版本锁定 起步依赖 自动配置 2. 搭建springboot项目 pom.xml 继承parent 导入xxx起步依赖（集合体） 启动类 @SpringBootApplication 配置文件 application.yml 3. yml配置文件 语法：严格区分大小写，使用缩进表示层级关系，属性值之前（冒号之间）必须有空格 格式： 普通类型 对象类型 集合类型	读取配置文件： @Value Enviroment @ConfigurationProperties 4. springboot整合其它框架 springboot &#43; springMVC &#43; mybatisPlus &#43; JSP等 一 SpringBoot 整合其它框架 1.0 整合FreeMark【掌握】 1.0.1 POM &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-freemarker&lt;/artifactId&gt; &lt;/dependency&gt; 1.0.2 启动类以及Controller三层 @SpringBootApplication public class SpringbootAllApplication { public static void main(String[] args) { SpringApplication.run(SpringbootAllApplication.class, args); } } 1.0.3 视图解析配置 spring.freemarker.template-loader-path=classpath:/templates/ spring.freemarker.suffix=.ftlh 1.0.4 页面 &lt;!"/>
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://cheneycqg.github.io/posts/springboot%E8%BF%9B%E9%98%B6%E7%AF%87/" /><link rel="prev" href="https://cheneycqg.github.io/posts/cyq/" /><link rel="next" href="https://cheneycqg.github.io/posts/test/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Test",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/cheneycqg.github.io\/posts\/springboot%E8%BF%9B%E9%98%B6%E7%AF%87\/"
        },"genre": "posts","wordcount":  1244 ,
        "url": "https:\/\/cheneycqg.github.io\/posts\/springboot%E8%BF%9B%E9%98%B6%E7%AF%87\/","datePublished": "2023-07-29T17:40:19+08:00","dateModified": "2023-07-29T17:40:19+08:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Author"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="My New Hugo Site">My cool site</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="My New Hugo Site">My cool site</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Test</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Author</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2023-07-29">2023-07-29</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1244 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;6 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#10-整合freemark掌握">1.0 整合FreeMark【掌握】</a>
      <ul>
        <li><a href="#101-pom">1.0.1 POM</a></li>
        <li><a href="#102-启动类以及controller三层">1.0.2 启动类以及Controller三层</a></li>
        <li><a href="#103-视图解析配置">1.0.3 视图解析配置</a></li>
        <li><a href="#104-页面">1.0.4 页面</a></li>
        <li><a href="#105-常见配置">1.0.5 常见配置</a></li>
      </ul>
    </li>
    <li><a href="#11-整合thymeleaf掌握">1.1 整合Thymeleaf【掌握】</a>
      <ul>
        <li><a href="#111-简介">1.1.1 简介</a></li>
        <li><a href="#112-搭建环境">1.1.2 搭建环境</a></li>
        <li><a href="#113-视图解析器配置">1.1.3 视图解析器配置</a></li>
        <li><a href="#114-页面">1.1.4 页面</a></li>
        <li><a href="#115-常见配置">1.1.5 常见配置</a></li>
      </ul>
    </li>
    <li><a href="#12-整合swagger">1.2 整合Swagger</a>
      <ul>
        <li><a href="#121介绍">1.2.1介绍</a></li>
        <li><a href="#122pom">1.2.2POM</a></li>
        <li><a href="#123启动类">1.2.3启动类</a></li>
        <li><a href="#124-swagger的注解">1.2.4 Swagger的注解</a></li>
      </ul>
    </li>
    <li><a href="#13-整合redis">1.3 整合Redis</a>
      <ul>
        <li><a href="#131-简介">1.3.1 简介</a></li>
        <li><a href="#132-搭建环境">1.3.2 搭建环境</a></li>
        <li><a href="#133-案例练习">1.3.3 案例练习</a></li>
      </ul>
    </li>
    <li><a href="#14-整合安全框架">1.4 整合安全框架</a>
      <ul>
        <li></li>
        <li><a href="#15-springboot配置文件的位置">1.5 SpringBoot配置文件的位置</a></li>
        <li><a href="#16-spingboot多环境开发">1.6 SpingBoot多环境开发</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#21-自动装配">2.1 自动装配</a></li>
    <li><a href="#22-装配redis">2.2 装配Redis</a></li>
    <li><a href="#23-知识小结">2.3 知识小结</a></li>
  </ul>

  <ul>
    <li><a href="#31-分析mybatisplus启动器">3.1 分析MybatisPlus启动器</a></li>
    <li><a href="#32-代码实现">3.2 代码实现</a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#33-引入测试">3.3 引入测试</a>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#41-jar包发布官方推荐">4.1 jar包发布（官方推荐）</a>
      <ul>
        <li><a href="#411-配置打包插件">4.1.1 配置打包插件</a></li>
        <li><a href="#412-执行java命令">4.1.2 执行java命令</a></li>
      </ul>
    </li>
    <li><a href="#42-war包发布了解">4.2 war包发布（了解）</a>
      <ul>
        <li><a href="#421-项目打包方式">4.2.1 项目打包方式</a></li>
        <li><a href="#422-配置启动类">4.2.2 配置启动类</a></li>
        <li><a href="#423-部署到tomcat">4.2.3 部署到Tomcat</a></li>
      </ul>
    </li>
    <li><a href="#43-自定义彩蛋">4.3 自定义彩蛋</a></li>
    <li><a href="#44-通过添加parent引入stringboot">4.4 通过添加<!-- raw HTML omitted -->引入StringBoot</a></li>
    <li><a href="#45-springboot热部署">4.5 SpringBoot热部署</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="回顾">回顾</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span><span style="color:#66d9ef">1.</span> springboot概述
</span></span><span style="display:flex;"><span>	主要作用就是帮我们快速的构建庞大的JavaEE项目
</span></span><span style="display:flex;"><span>	特点：
</span></span><span style="display:flex;"><span>		版本锁定
</span></span><span style="display:flex;"><span>		起步依赖
</span></span><span style="display:flex;"><span>		自动配置
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">2.</span> 搭建springboot项目
</span></span><span style="display:flex;"><span>	pom.xml
</span></span><span style="display:flex;"><span>		继承parent
</span></span><span style="display:flex;"><span>		导入xxx起步依赖（集合体）
</span></span><span style="display:flex;"><span>	启动类
</span></span><span style="display:flex;"><span>		@SpringBootApplication
</span></span><span style="display:flex;"><span>	配置文件
</span></span><span style="display:flex;"><span>		application.yml
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">3.</span> yml配置文件
</span></span><span style="display:flex;"><span>	语法：严格区分大小写，使用缩进表示层级关系，属性值之前（冒号之间）必须有空格
</span></span><span style="display:flex;"><span>	格式：
</span></span><span style="display:flex;"><span>		普通类型
</span></span><span style="display:flex;"><span>		对象类型
</span></span><span style="display:flex;"><span>		集合类型	
</span></span><span style="display:flex;"><span>	读取配置文件：
</span></span><span style="display:flex;"><span>		@Value
</span></span><span style="display:flex;"><span>		Enviroment
</span></span><span style="display:flex;"><span>		@ConfigurationProperties
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">4.</span> springboot整合其它框架
</span></span><span style="display:flex;"><span>	springboot + springMVC  + mybatisPlus + JSP等
</span></span></code></pre></div><h1 id="一-springboot-整合其它框架">一 SpringBoot 整合其它框架</h1>
<h2 id="10-整合freemark掌握">1.0 整合FreeMark【掌握】</h2>
<h3 id="101-pom">1.0.1 POM</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-freemarker<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h3 id="102-启动类以及controller三层">1.0.2 启动类以及Controller三层</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@SpringBootApplication</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SpringbootAllApplication</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		SpringApplication<span style="color:#f92672">.</span><span style="color:#a6e22e">run</span><span style="color:#f92672">(</span>SpringbootAllApplication<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">,</span> args<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="103-视图解析配置">1.0.3 视图解析配置</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>spring.freemarker.template-loader-path=classpath:/templates/
</span></span><span style="display:flex;"><span>spring.freemarker.suffix=.ftlh
</span></span></code></pre></div><h3 id="104-页面">1.0.4 页面</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span> <span style="color:#a6e22e">lang</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;en&#34;</span> &gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">title</span>&gt;Thymeleaf&lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">table</span> <span style="color:#a6e22e">border</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1px&#34;</span> <span style="color:#a6e22e">width</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;500px&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">tr</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">td</span>&gt;编号&lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">td</span>&gt;书名&lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">tr</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">&lt;</span>#list users as user&gt;
</span></span><span style="display:flex;"><span>       &lt;<span style="color:#f92672">tr</span>&gt;
</span></span><span style="display:flex;"><span>           &lt;<span style="color:#f92672">td</span>&gt;${user.name}&lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>           &lt;<span style="color:#f92672">td</span>&gt;${user.age}&lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">tr</span>&gt;
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">&lt;</span>/#list&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">table</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><h3 id="105-常见配置">1.0.5 常见配置</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>spring:
</span></span><span style="display:flex;"><span>  freemarker:
</span></span><span style="display:flex;"><span>    #设置编码格式
</span></span><span style="display:flex;"><span>    charset: utf-8
</span></span><span style="display:flex;"><span>    #设置文件后缀
</span></span><span style="display:flex;"><span>    suffix: .ftl
</span></span><span style="display:flex;"><span>    #设置ftl文件路径
</span></span><span style="display:flex;"><span>    template-loader-path: classpath:/templates
</span></span><span style="display:flex;"><span>    #关闭缓存，及时刷新，上线生产环境需要改为true
</span></span><span style="display:flex;"><span>    cache: false
</span></span></code></pre></div><h2 id="11-整合thymeleaf掌握">1.1 整合Thymeleaf【掌握】</h2>
<h3 id="111-简介">1.1.1 简介</h3>
<p>Thymeleaf是一个用于展示页面的模板引擎，通俗来讲，就是java工程师用于开发html页面的，之前我们学的是jsp也可以开发页面，但是springboot 推荐用Thymeleaf，为什么呢？</p>
<p>原因有2个：</p>
<ol>
<li>Thymeleaf运行效率比jsp高</li>
<li>Thymeleaf开发起来比jsp简单</li>
</ol>
<h3 id="112-搭建环境">1.1.2 搭建环境</h3>
<blockquote>
<p>第一步，创建java模块，导入依赖</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;dependencies&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">&lt;!--thymeleaf起步依赖--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-thymeleaf<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependencies&gt;</span>
</span></span></code></pre></div><blockquote>
<p>第二步，编写启动类</p>
<p>第三步 ，Controller,Servce和Mapper</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@SpringBootApplication</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ThymeleafApp</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        SpringApplication<span style="color:#f92672">.</span><span style="color:#a6e22e">run</span><span style="color:#f92672">(</span>ThymeleafApp<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">,</span> args<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="113-视图解析器配置">1.1.3 视图解析器配置</h3>
<p>springboot默认使用的就是Thymeleaf视图解析器</p>
<p>执行页面跳转的时候，自动的从resource中的templates文件夹中找到对应的 xxx.html页面</p>
<blockquote>
<p>springboot启动时，加载<code>org.springframework.boot.autoconfigure.thymeleaf.ThymeleafProperties</code>资源属性类</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/image-20201211085435057.png"
        data-srcset="assets/image-20201211085435057.png, assets/image-20201211085435057.png 1.5x, assets/image-20201211085435057.png 2x"
        data-sizes="auto"
        alt="assets/image-20201211085435057.png"
        title="image-20201211085435057" /></p>
<h3 id="114-页面">1.1.4 页面</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span> <span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>		&lt;<span style="color:#f92672">html</span> <span style="color:#a6e22e">lang</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;en&#34;</span> <span style="color:#a6e22e">xmlns:th</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;http://www.thymeleaf.org&#34;</span>&gt;
</span></span><span style="display:flex;"><span>		&lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>			&lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;
</span></span><span style="display:flex;"><span>			&lt;<span style="color:#f92672">title</span>&gt;Thymeleaf&lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>		&lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>		&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>		&lt;<span style="color:#f92672">table</span> <span style="color:#a6e22e">border</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1px&#34;</span> <span style="color:#a6e22e">width</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;500px&#34;</span>&gt;
</span></span><span style="display:flex;"><span>			&lt;<span style="color:#f92672">tr</span>&gt;
</span></span><span style="display:flex;"><span>				&lt;<span style="color:#f92672">td</span>&gt;编号&lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>				&lt;<span style="color:#f92672">td</span>&gt;书名&lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>				&lt;<span style="color:#f92672">td</span>&gt;价格&lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>			&lt;/<span style="color:#f92672">tr</span>&gt;
</span></span><span style="display:flex;"><span>			&lt;<span style="color:#f92672">tr</span> <span style="color:#a6e22e">th:each</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;book : ${books}&#34;</span>&gt;
</span></span><span style="display:flex;"><span>				&lt;<span style="color:#f92672">td</span> <span style="color:#a6e22e">th:text</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;${book.bid}&#34;</span>&gt;&lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>				&lt;<span style="color:#f92672">td</span> <span style="color:#a6e22e">th:text</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;${book.bname}&#34;</span>&gt;&lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>				&lt;<span style="color:#f92672">td</span> <span style="color:#a6e22e">th:text</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;${book.price}&#34;</span>&gt;&lt;/<span style="color:#f92672">td</span>&gt;
</span></span><span style="display:flex;"><span>			&lt;/<span style="color:#f92672">tr</span>&gt;
</span></span><span style="display:flex;"><span>		&lt;/<span style="color:#f92672">table</span>&gt;
</span></span><span style="display:flex;"><span>	&lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;
</span></span></code></pre></div><h3 id="115-常见配置">1.1.5 常见配置</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>#页面编码
</span></span><span style="display:flex;"><span>spring.thymeleaf.encoding=UTF-8
</span></span><span style="display:flex;"><span>#返回模板类型
</span></span><span style="display:flex;"><span>spring.thymeleaf.servlet.content-type=text/html
</span></span><span style="display:flex;"><span>#开发时关闭缓存,不然没法看到实时页面
</span></span><span style="display:flex;"><span>spring.thymeleaf.cache=false
</span></span><span style="display:flex;"><span># 在构建URL时预先查看名称的前缀 （默认就是这个）
</span></span><span style="display:flex;"><span>spring.thymeleaf.prefix=classpath:/templates/
</span></span><span style="display:flex;"><span># 构建URL时附加查看名称的后缀.（默认就是 html的结尾的）
</span></span><span style="display:flex;"><span>spring.thymeleaf.suffix=.html
</span></span></code></pre></div><h2 id="12-整合swagger">1.2 整合Swagger</h2>
<h3 id="121介绍">1.2.1介绍</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>接口文档在线生成工具  
</span></span></code></pre></div><h3 id="122pom">1.2.2POM</h3>
<ul>
<li>注意Swagger2.x需要<strong>Springboot2.6.0</strong>以下版本</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;!--  swagger2核心功能jar包--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;groupId&gt;</span>io.springfox<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;artifactId&gt;</span>springfox-swagger2<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;version&gt;</span>2.9.2<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- 界面jar包,用于在浏览器端可以查看的界面 --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;groupId&gt;</span>io.springfox<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;artifactId&gt;</span>springfox-swagger-ui<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;version&gt;</span>2.9.2<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">配置类</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SwaggerConfig</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * 创建API应用
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * apiInfo() 增加API相关信息
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * 通过select()函数返回一个ApiSelectorBuilder实例,用来控制哪些接口暴露给Swagger来展现，
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * 本例采用指定扫描的包路径来定义指定要建立API的目录。
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * @return
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Docket <span style="color:#a6e22e">createRestApi</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        * DocumentationType.SWAGGER_2  表示版本号是 swagger 2.0
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        * pathMapping   路径映射
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        * select 设置哪些接口暴露给Swagger展示
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *       为当前包下controller生成API文档
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        * .apis(RequestHandlerSelectors.basePackage(&#34;com.xh&#34;))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *      为有@Api注解的Controller生成API文档
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *.apis(RequestHandlerSelectors.withClassAnnotation(Api.class))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">                为有@ApiOperation注解的方法生成API文档
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *.apis(RequestHandlerSelectors.withMethodAnnotation(ApiOperation.class))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *    为任何接口生成API文档
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        * .apis(RequestHandlerSelectors.any())
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *       所有的controller都显示
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        * paths(PathSelectors.any())
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *       所有controller都不显示
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        * paths(PathSelectors.none())
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *        该正则表示匹配所有
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        * paths(PathSelectors.regex(&#34;^[+-@=](.*?)&#34;))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *        匹配/test-swagger2/开头的所有controller
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        * paths(PathSelectors.ant(&#34;/test-swagger2/**&#34;))
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *   指定构建api文档的详细信息的方法
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        * .apiInfo(
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *   new ApiInfoBuilder().title()   //标题
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *   .description()   //描述
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *   .version()     //版本号
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *   .contact(
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *       new Contact(
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *       &#34;作者名字&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *       &#34;作者的网站&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *       &#34;作者的邮箱&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *       )
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *   ).  //配置作者信息的
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *   license().  //描述谁认证的权限
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        * )licenseUrl(). 认证的权限的网址
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        * */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Docket<span style="color:#f92672">(</span>DocumentationType<span style="color:#f92672">.</span><span style="color:#a6e22e">SWAGGER_2</span><span style="color:#f92672">).</span>
</span></span><span style="display:flex;"><span>                pathMapping<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/&#34;</span><span style="color:#f92672">).</span>
</span></span><span style="display:flex;"><span>                select<span style="color:#f92672">().</span><span style="color:#a6e22e">apis</span><span style="color:#f92672">(</span>RequestHandlerSelectors<span style="color:#f92672">.</span><span style="color:#a6e22e">basePackage</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;com.zhyp&#34;</span><span style="color:#f92672">)).</span>
</span></span><span style="display:flex;"><span>                paths<span style="color:#f92672">(</span>PathSelectors<span style="color:#f92672">.</span><span style="color:#a6e22e">any</span><span style="color:#f92672">()).</span><span style="color:#a6e22e">build</span><span style="color:#f92672">().</span><span style="color:#a6e22e">apiInfo</span><span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">new</span> ApiInfoBuilder<span style="color:#f92672">().</span>
</span></span><span style="display:flex;"><span>                        title<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;SpringBoot整合Swagger&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                        <span style="color:#f92672">.</span><span style="color:#a6e22e">description</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;这里是描述&#34;</span><span style="color:#f92672">).</span>
</span></span><span style="display:flex;"><span>                        version<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;1.0版本&#34;</span><span style="color:#f92672">).</span>
</span></span><span style="display:flex;"><span>                        contact<span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> Contact<span style="color:#f92672">(</span>
</span></span><span style="display:flex;"><span>                                <span style="color:#e6db74">&#34;xiaohao&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>                                <span style="color:#e6db74">&#34;www.xiaohao.com&#34;</span><span style="color:#f92672">,</span>
</span></span><span style="display:flex;"><span>                                <span style="color:#e6db74">&#34;1927701569@qq.com&#34;</span><span style="color:#f92672">)).</span>
</span></span><span style="display:flex;"><span>                        license<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Apache 认证&#34;</span><span style="color:#f92672">).</span>
</span></span><span style="display:flex;"><span>                        licenseUrl<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;http://www.xiaohao.com&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">build</span><span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="123启动类">1.2.3启动类</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@SpringBootApplication</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@EnableSwagger2</span> <span style="color:#75715e">//开启Swagger2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SpringbootSwagger2Application</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		SpringApplication<span style="color:#f92672">.</span><span style="color:#a6e22e">run</span><span style="color:#f92672">(</span>SpringbootSwagger2Application<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">,</span> args<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">访问接口</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>http:<span style="color:#75715e">//localhost:端口号/项目名/swagger-ui.html
</span></span></span></code></pre></div><h3 id="124-swagger的注解">1.2.4 Swagger的注解</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>@Api	表示对类的说明常用类上面
</span></span><span style="display:flex;"><span>@ApiOperation	说明方法的用途、作用	方法上面
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>@ApiModel	表示一个返回响应数据的信息	响应类
</span></span><span style="display:flex;"><span>@ApiModelProperty	描述响应类的属性	属性
</span></span></code></pre></div><h2 id="13-整合redis">1.3 整合Redis</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="image%5c1689228453856-1689228454207.png"
        data-srcset="image%5c1689228453856-1689228454207.png, image%5c1689228453856-1689228454207.png 1.5x, image%5c1689228453856-1689228454207.png 2x"
        data-sizes="auto"
        alt="image\1689228453856-1689228454207.png"
        title="1689228453856" /></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ae81ff">1.</span><span style="color:#960050;background-color:#1e0010">什么是</span>Redis<span style="color:#f92672">?</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">一款基于内存的非关系型数据库</span><span style="color:#f92672">(</span><span style="color:#960050;background-color:#1e0010">键值对数据库</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2.</span><span style="color:#960050;background-color:#1e0010">启动</span>Redis<span style="color:#f92672">:</span> <span style="color:#960050;background-color:#1e0010">服务端</span>redis<span style="color:#f92672">-</span>server<span style="color:#f92672">.</span><span style="color:#a6e22e">exe</span><span style="color:#f92672">(</span><span style="color:#960050;background-color:#1e0010">双击启动</span><span style="color:#f92672">),</span><span style="color:#960050;background-color:#1e0010">默认端口</span><span style="color:#ae81ff">6379</span>
</span></span><span style="display:flex;"><span>			<span style="color:#960050;background-color:#1e0010">客户端</span>redis<span style="color:#f92672">-</span>cli<span style="color:#f92672">.</span><span style="color:#a6e22e">exe</span><span style="color:#f92672">(</span><span style="color:#960050;background-color:#1e0010">双击启动</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3.</span>Redis<span style="color:#960050;background-color:#1e0010">基本命令</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#960050;background-color:#1e0010">通用命令</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>        Keys <span style="color:#f92672">*</span> <span style="color:#960050;background-color:#1e0010">查看所有的键</span>
</span></span><span style="display:flex;"><span>        del key <span style="color:#960050;background-color:#1e0010">删除某个键值对</span>
</span></span><span style="display:flex;"><span>        flushall <span style="color:#960050;background-color:#1e0010">清空所有库的所有键</span>
</span></span><span style="display:flex;"><span>		flushdb <span style="color:#960050;background-color:#1e0010">清空当前库所有键</span>
</span></span><span style="display:flex;"><span>		select <span style="color:#a6e22e">dbIndex</span><span style="color:#f92672">(</span><span style="color:#ae81ff">0</span><span style="color:#f92672">-</span><span style="color:#ae81ff">15</span><span style="color:#f92672">)</span> <span style="color:#960050;background-color:#1e0010">切换数据库</span>
</span></span><span style="display:flex;"><span>	String<span style="color:#960050;background-color:#1e0010">类型数据的命令</span>
</span></span><span style="display:flex;"><span>		set key value  <span style="color:#960050;background-color:#1e0010">设置键值对</span>
</span></span><span style="display:flex;"><span>		get key <span style="color:#960050;background-color:#1e0010">根据键获取值</span>
</span></span><span style="display:flex;"><span>		del key <span style="color:#960050;background-color:#1e0010">删除某个键值对</span>
</span></span><span style="display:flex;"><span>		incr key <span style="color:#960050;background-color:#1e0010">为某个键的值加</span><span style="color:#ae81ff">1</span>  
</span></span><span style="display:flex;"><span>		decr key <span style="color:#960050;background-color:#1e0010">为某个键的值减</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>		incrby key number <span style="color:#960050;background-color:#1e0010">为某个键的值加</span>number
</span></span><span style="display:flex;"><span>		decrby key number <span style="color:#960050;background-color:#1e0010">为某个键的值减</span>number
</span></span><span style="display:flex;"><span>	List
</span></span><span style="display:flex;"><span>		<span style="color:#960050;background-color:#1e0010">命令</span>
</span></span><span style="display:flex;"><span>	Set
</span></span><span style="display:flex;"><span>		<span style="color:#960050;background-color:#1e0010">命令</span>
</span></span><span style="display:flex;"><span>	Hash   user1<span style="color:#f92672">:</span> <span style="color:#f92672">{</span>name<span style="color:#f92672">:</span>jack<span style="color:#f92672">,</span>age<span style="color:#f92672">:</span><span style="color:#ae81ff">18</span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#960050;background-color:#1e0010">命令</span>
</span></span><span style="display:flex;"><span>	ZSet   <span style="color:#960050;background-color:#1e0010">排序集合</span>
</span></span><span style="display:flex;"><span>		<span style="color:#960050;background-color:#1e0010">命令</span>
</span></span><span style="display:flex;"><span>	
</span></span></code></pre></div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets%5c1682236873786.png"
        data-srcset="assets%5c1682236873786.png, assets%5c1682236873786.png 1.5x, assets%5c1682236873786.png 2x"
        data-sizes="auto"
        alt="assets\1682236873786.png"
        title="1682236873786" /></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ae81ff">4.</span><span style="color:#960050;background-color:#1e0010">使用</span>Java<span style="color:#960050;background-color:#1e0010">客户端</span><span style="color:#f92672">,</span>Jedis<span style="color:#960050;background-color:#1e0010">来操作</span>Redis
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;</span>dependency<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;</span>groupId<span style="color:#f92672">&gt;</span>redis<span style="color:#f92672">.</span><span style="color:#a6e22e">clients</span><span style="color:#f92672">&lt;/</span>groupId<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;</span>artifactId<span style="color:#f92672">&gt;</span>jedis<span style="color:#f92672">&lt;/</span>artifactId<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/</span>dependency<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">测试</span>Jedis<span style="color:#960050;background-color:#1e0010">的使用</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@SpringBootTest</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SpringbootRedisApplicationTests</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testJedis</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		Jedis jedis <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Jedis<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;localhost&#34;</span><span style="color:#f92672">,</span><span style="color:#ae81ff">6379</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		jedis<span style="color:#f92672">.</span><span style="color:#a6e22e">set</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;address&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;beijing&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		jedis<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testJedis02</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		Jedis jedis <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Jedis<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;localhost&#34;</span><span style="color:#f92672">,</span><span style="color:#ae81ff">6379</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>jedis<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;address&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>		jedis<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testJedis03</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>		JedisPool jedisPool <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> JedisPool<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;localhost&#34;</span><span style="color:#f92672">,</span><span style="color:#ae81ff">6379</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>		Jedis jedis <span style="color:#f92672">=</span> jedisPool<span style="color:#f92672">.</span><span style="color:#a6e22e">getResource</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>		System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>jedis<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;address&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>		jedis<span style="color:#f92672">.</span><span style="color:#a6e22e">close</span><span style="color:#f92672">();</span><span style="color:#75715e">//动态代理 装饰者设计模式
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="131-简介">1.3.1 简介</h3>
<p>spring为了让开发者简化Jedis的操作，提供了<code>spring-data-redis</code>框架，它对reids底层开发包(Jedis)进行了高度封装，通过<code>RedisTemplate</code>对象实现了redis各种操作、异常处理及序列化，支持发布订阅等功能。</p>
<h3 id="132-搭建环境">1.3.2 搭建环境</h3>
<h4 id="-导入依赖">① 导入依赖</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/image-20201211091355332.png"
        data-srcset="assets/image-20201211091355332.png, assets/image-20201211091355332.png 1.5x, assets/image-20201211091355332.png 2x"
        data-sizes="auto"
        alt="assets/image-20201211091355332.png"
        title="image-20201211091355332" /></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;!--redis 起步依赖--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-data-redis<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h4 id="-启动redis环境">② 启动redis环境</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/image-20201211091449091.png"
        data-srcset="assets/image-20201211091449091.png, assets/image-20201211091449091.png 1.5x, assets/image-20201211091449091.png 2x"
        data-sizes="auto"
        alt="assets/image-20201211091449091.png"
        title="image-20201211091449091" /></p>
<h4 id="-applicationyml">③ application.yml</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/image-20201211091613208.png"
        data-srcset="assets/image-20201211091613208.png, assets/image-20201211091613208.png 1.5x, assets/image-20201211091613208.png 2x"
        data-sizes="auto"
        alt="assets/image-20201211091613208.png"
        title="image-20201211091613208" /></p>
<p>③ 使用</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@RunWith</span><span style="color:#f92672">(</span>SpringRunner<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@SpringBootTest</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RedisTest</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> RedisTemplate redisTemplate<span style="color:#f92672">;</span> <span style="color:#75715e">// 将java对象序列化并存储到redis中
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> StringRedisTemplate stringRedisTemplate<span style="color:#f92672">;</span> <span style="color:#75715e">// 将java对象转为字符串并存储到redis中
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test01</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        redisTemplate<span style="color:#f92672">.</span><span style="color:#a6e22e">opsForValue</span><span style="color:#f92672">().</span><span style="color:#a6e22e">set</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;a1&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;hehe&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        stringRedisTemplate<span style="color:#f92672">.</span><span style="color:#a6e22e">opsForValue</span><span style="color:#f92672">().</span><span style="color:#a6e22e">set</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;a2&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;hehe&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//操作string类型
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>redisTemplate<span style="color:#f92672">.</span><span style="color:#a6e22e">opsForValue</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//操作hash类型
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>redisTemplate<span style="color:#f92672">.</span><span style="color:#a6e22e">opsForHash</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//操作list类型
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>redisTemplate<span style="color:#f92672">.</span><span style="color:#a6e22e">opsForList</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//操作set类型
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>redisTemplate<span style="color:#f92672">.</span><span style="color:#a6e22e">opsForSet</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//操作有序set类型
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>redisTemplate<span style="color:#f92672">.</span><span style="color:#a6e22e">opsForZSet</span><span style="color:#f92672">();</span>
</span></span></code></pre></div><h3 id="133-案例练习">1.3.3 案例练习</h3>
<p><strong>需求</strong></p>
<p>使用redis对用户列表数据进行缓存优化</p>
<h4 id="user">User</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/image-20201211093226514.png"
        data-srcset="assets/image-20201211093226514.png, assets/image-20201211093226514.png 1.5x, assets/image-20201211093226514.png 2x"
        data-sizes="auto"
        alt="assets/image-20201211093226514.png"
        title="image-20201211093226514" /></p>
<h4 id="userservice">UserService</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Service</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UserService</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> UserMapper userMapper<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> RedisTemplate redisTemplate<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> List<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">findAll</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;</span> userList <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>redisTemplate<span style="color:#f92672">.</span><span style="color:#a6e22e">hasKey</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;userList&#34;</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// 1.先查询缓存
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            userList <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>List<span style="color:#f92672">&lt;</span>User<span style="color:#f92672">&gt;)</span> redisTemplate<span style="color:#f92672">.</span><span style="color:#a6e22e">opsForValue</span><span style="color:#f92672">().</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;userList&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;查询缓存&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span> <span style="color:#66d9ef">else</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// 2.在查询mysql，存入到redis中
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            userList <span style="color:#f92672">=</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectList</span><span style="color:#f92672">(</span><span style="color:#66d9ef">null</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            redisTemplate<span style="color:#f92672">.</span><span style="color:#a6e22e">opsForValue</span><span style="color:#f92672">().</span><span style="color:#a6e22e">set</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;userList&#34;</span><span style="color:#f92672">,</span> userList<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;查询数据库&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> userList<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> User <span style="color:#a6e22e">findById</span><span style="color:#f92672">(</span>Long id<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> userMapper<span style="color:#f92672">.</span><span style="color:#a6e22e">selectById</span><span style="color:#f92672">(</span>id<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span> 
</span></span></code></pre></div><h2 id="14-整合安全框架">1.4 整合安全框架</h2>
<ul>
<li>国内使用比较的多的安全框架有shiro和Spring security</li>
<li>主要功能是认证和授权</li>
</ul>
<h4 id="140-spring-security">1.4.0 Spring security</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>依赖: 导入依赖后所有资源都被限制访问,如果想要关闭可以在启动类中排除@SpringBootApplication(exclude = SecurityAutoConfiguration.class)
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-security<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h4 id="141-基于配置文件创建用户">1.4.1 基于配置文件创建用户</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>spring.security.user.name=jack
</span></span><span style="display:flex;"><span>spring.security.user.password=123
</span></span><span style="display:flex;"><span>spring.security.user.roles=USER
</span></span></code></pre></div><h4 id="142-基于内存创建用户">1.4.2 基于内存创建用户</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">WebSecurtyConfg</span> <span style="color:#66d9ef">extends</span> WebSecurityConfigurerAdapter <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> PasswordEncoder <span style="color:#a6e22e">getPasswordEncoder</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> NoOpPasswordEncoder<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">configure</span><span style="color:#f92672">(</span>AuthenticationManagerBuilder auth<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">         * 基于内存的方式，创建两个用户admin/1234，user/1234，zhyp/1234
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">         * */</span>
</span></span><span style="display:flex;"><span>        auth<span style="color:#f92672">.</span><span style="color:#a6e22e">inMemoryAuthentication</span><span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">.</span><span style="color:#a6e22e">withUser</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;admin&#34;</span><span style="color:#f92672">)</span><span style="color:#75715e">//用户名
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#f92672">.</span><span style="color:#a6e22e">password</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;1234&#34;</span><span style="color:#f92672">)</span><span style="color:#75715e">//密码
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#f92672">.</span><span style="color:#a6e22e">roles</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ADMIN&#34;</span><span style="color:#f92672">);</span><span style="color:#75715e">//角色
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        auth<span style="color:#f92672">.</span><span style="color:#a6e22e">inMemoryAuthentication</span><span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">.</span><span style="color:#a6e22e">withUser</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;user&#34;</span><span style="color:#f92672">)</span><span style="color:#75715e">//用户名
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#f92672">.</span><span style="color:#a6e22e">password</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;1234&#34;</span><span style="color:#f92672">)</span><span style="color:#75715e">//密码
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#f92672">.</span><span style="color:#a6e22e">roles</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;USER&#34;</span><span style="color:#f92672">);</span><span style="color:#75715e">//角色
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        auth<span style="color:#f92672">.</span><span style="color:#a6e22e">inMemoryAuthentication</span><span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">.</span><span style="color:#a6e22e">withUser</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;zhyp&#34;</span><span style="color:#f92672">)</span><span style="color:#75715e">//用户名
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#f92672">.</span><span style="color:#a6e22e">password</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;1234&#34;</span><span style="color:#f92672">)</span><span style="color:#75715e">//密码
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#f92672">.</span><span style="color:#a6e22e">roles</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;USER&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;ADMIN&#34;</span><span style="color:#f92672">);</span><span style="color:#75715e">//角色
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h4 id="143-基于数据库创建用户">1.4.3 基于数据库创建用户</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">//@Service
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AdminServiceImpl</span> <span style="color:#66d9ef">implements</span> UserDetailsService <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> UserDetails <span style="color:#a6e22e">loadUserByUsername</span><span style="color:#f92672">(</span>String name<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> UsernameNotFoundException <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 对用户权限进行封装
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        List<span style="color:#f92672">&lt;</span>SimpleGrantedAuthority<span style="color:#f92672">&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>        list<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> SimpleGrantedAuthority<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ROLE_ADMIN&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 返回封装的UserDetails用户详情类
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/////////////////////////&#34;</span><span style="color:#f92672">+</span>name<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        UserDetails userDetails <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> User<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;ttt&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;1234&#34;</span><span style="color:#f92672">,</span> list<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> userDetails<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">WebSecurtyConfg</span> <span style="color:#66d9ef">extends</span> WebSecurityConfigurerAdapter <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> PasswordEncoder <span style="color:#a6e22e">getPasswordEncoder</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> NoOpPasswordEncoder<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">configure</span><span style="color:#f92672">(</span>AuthenticationManagerBuilder auth<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>	 	auth<span style="color:#f92672">.</span><span style="color:#a6e22e">userDetailsService</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> AdminServiceImpl<span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h4 id="144-权限验证">1.4.4 权限验证</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">configure</span><span style="color:#f92672">(</span>HttpSecurity http<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    http<span style="color:#f92672">.</span><span style="color:#a6e22e">authorizeRequests</span><span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">.</span><span style="color:#a6e22e">antMatchers</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/admin/**&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span><span style="color:#a6e22e">access</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;hasAnyRole(&#39;ADMIN&#39;)&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span><span style="color:#a6e22e">antMatchers</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/user/**&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span><span style="color:#a6e22e">access</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;hasAnyRole(&#39;USER&#39;,&#39;ADMIN&#39;)&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span><span style="color:#a6e22e">anyRequest</span><span style="color:#f92672">().</span><span style="color:#a6e22e">authenticated</span><span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span><span style="color:#a6e22e">and</span><span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">.</span><span style="color:#a6e22e">formLogin</span><span style="color:#f92672">().</span><span style="color:#a6e22e">loginProcessingUrl</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/login&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">permitAll</span><span style="color:#f92672">().</span>
</span></span><span style="display:flex;"><span>        and<span style="color:#f92672">().</span><span style="color:#a6e22e">cors</span><span style="color:#f92672">().</span><span style="color:#a6e22e">disable</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h4 id="145-springboot整合shiro">1.4.5 Springboot整合shiro</h4>
<ul>
<li>
<p>1.引入依赖</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;groupId&gt;</span>org.apache.shiro<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;artifactId&gt;</span>shiro-spring-boot-web-starter<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;version&gt;</span>1.8.0<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-thymeleaf<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span></code></pre></div><ul>
<li><strong>如果这时候什么都不做直接启动程序,会报错缺少Realm</strong></li>
</ul>
</li>
<li>
<p>2.配置核心</p>
<ul>
<li>经过配置Realm后,项目可以生成启动,但是任何资源都无法访问</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ShroConf</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Realm <span style="color:#a6e22e">realm</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>        TextConfigurationRealm realm <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> TextConfigurationRealm<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//设置账户和密码 还有角色
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        realm<span style="color:#f92672">.</span><span style="color:#a6e22e">setUserDefinitions</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;jack=123,user\n admin=123,admin&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//授予角色权限
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      realm<span style="color:#f92672">.</span><span style="color:#a6e22e">setRoleDefinitions</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;admin=read,write\n user=read&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> realm<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><ul>
<li>
<p>3.继续配置</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="image%5c1689316723948-1689316724332.png"
        data-srcset="image%5c1689316723948-1689316724332.png, image%5c1689316723948-1689316724332.png 1.5x, image%5c1689316723948-1689316724332.png 2x"
        data-sizes="auto"
        alt="image\1689316723948-1689316724332.png"
        title="1689316723948" /></p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span>application<span style="color:#f92672">.</span><span style="color:#a6e22e">properties</span><span style="color:#f92672">:</span> <span style="color:#960050;background-color:#1e0010">配置登陆页面的</span>url <span style="color:#960050;background-color:#1e0010">为</span><span style="color:#f92672">/</span>login
</span></span><span style="display:flex;"><span>shiro<span style="color:#f92672">.</span><span style="color:#a6e22e">loginUrl</span><span style="color:#f92672">=/</span>login  
</span></span><span style="display:flex;"><span><span style="color:#75715e">//过滤和放行设置
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">@Bean</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> ShiroFilterChainDefinition <span style="color:#a6e22e">shiroFilterChainDefinition</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>	DefaultShiroFilterChainDefinition chainDefinition <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">new</span> DefaultShiroFilterChainDefinition<span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//anon放行  不拦截
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	chainDefinition<span style="color:#f92672">.</span><span style="color:#a6e22e">addPathDefinition</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/login&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;anon&#34;</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//anon放行  不拦截
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	chainDefinition<span style="color:#f92672">.</span><span style="color:#a6e22e">addPathDefinition</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/doLogin&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;anon&#34;</span><span style="color:#f92672">);</span> 
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//需要认证
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	chainDefinition<span style="color:#f92672">.</span><span style="color:#a6e22e">addPathDefinition</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/**&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;authc&#34;</span><span style="color:#f92672">);</span>  
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> chainDefinition<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">设置放行后还是报错</span><span style="color:#f92672">,</span><span style="color:#960050;background-color:#1e0010">因为没有</span><span style="color:#f92672">/</span>login<span style="color:#960050;background-color:#1e0010">这个地址</span>
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@RequestMapping</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/login&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">login</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;login&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">以上配置很麻烦</span><span style="color:#f92672">,</span><span style="color:#960050;background-color:#1e0010">每个放行的</span><span style="color:#f92672">/</span>xxx<span style="color:#960050;background-color:#1e0010">都需要单独写一个</span>RequestMapping
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">WebMvcConfig</span> <span style="color:#66d9ef">implements</span> WebMvcConfigurer <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">addViewControllers</span><span style="color:#f92672">(</span>ViewControllerRegistry registry<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        registry<span style="color:#f92672">.</span><span style="color:#a6e22e">addViewController</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/login&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">setViewName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;login&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        registry<span style="color:#f92672">.</span><span style="color:#a6e22e">addViewController</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/index&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">setViewName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;index&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//俩个参数  前面的是控制器    后面的是页面的名字
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        registry<span style="color:#f92672">.</span><span style="color:#a6e22e">addViewController</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/unauthorized&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">setViewName</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;unauthorized&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>4.登陆逻辑</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#a6e22e">@RequestMapping</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/doLogin&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">doLogin</span><span style="color:#f92672">(</span>String username<span style="color:#f92672">,</span> String pwd<span style="color:#f92672">,</span> Model model<span style="color:#f92672">){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//使用shiro中提供的方法
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        UsernamePasswordToken token <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> UsernamePasswordToken<span style="color:#f92672">(</span>username<span style="color:#f92672">,</span>pwd<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//获取主体
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        Subject subject <span style="color:#f92672">=</span> SecurityUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">getSubject</span><span style="color:#f92672">();</span>  <span style="color:#75715e">//获取请求的用户
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">try</span><span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            subject<span style="color:#f92672">.</span><span style="color:#a6e22e">login</span><span style="color:#f92672">(</span>token<span style="color:#f92672">);</span>   <span style="color:#75715e">//登录
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#f92672">}</span><span style="color:#66d9ef">catch</span><span style="color:#f92672">(</span>Exception ex<span style="color:#f92672">){</span>
</span></span><span style="display:flex;"><span>            model<span style="color:#f92672">.</span><span style="color:#a6e22e">addAttribute</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;error&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;用户名或者密码错误了！！！&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>            ex<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;login&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;index&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span></code></pre></div><p>5.其他逻辑</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@RequiresRoles</span><span style="color:#f92672">(</span>value <span style="color:#f92672">=</span> <span style="color:#f92672">{</span><span style="color:#e6db74">&#34;admin&#34;</span><span style="color:#f92672">,</span><span style="color:#e6db74">&#34;user&#34;</span><span style="color:#f92672">},</span>logical <span style="color:#f92672">=</span> Logical<span style="color:#f92672">.</span><span style="color:#a6e22e">OR</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@RequestMapping</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/user&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">user</span><span style="color:#f92672">(){</span>   <span style="color:#75715e">//普通用户和管理员你都能访问
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;user&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@RequiresRoles</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;admin&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@RequestMapping</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/admin&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">admin</span><span style="color:#f92672">(){</span>   <span style="color:#75715e">//只有管理员才能访问
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;admin&#34;</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="15-springboot配置文件的位置">1.5 SpringBoot配置文件的位置</h3>
<ul>
<li>注意: 我们要把配置文件放在项目的根目录而不是模块的根目录</li>
<li>1.config下比不config优先级高</li>
<li>2.路径越靠外的优先级越高</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/5a9c57df102849c6b3c1cb95cd61c2a1.png"
        data-srcset="assets/5a9c57df102849c6b3c1cb95cd61c2a1.png, assets/5a9c57df102849c6b3c1cb95cd61c2a1.png 1.5x, assets/5a9c57df102849c6b3c1cb95cd61c2a1.png 2x"
        data-sizes="auto"
        alt="assets/5a9c57df102849c6b3c1cb95cd61c2a1.png"
        title="在这里插入图片描述" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/446c96dd365c49dc89ccb67a87dcdb2b.png"
        data-srcset="assets/446c96dd365c49dc89ccb67a87dcdb2b.png, assets/446c96dd365c49dc89ccb67a87dcdb2b.png 1.5x, assets/446c96dd365c49dc89ccb67a87dcdb2b.png 2x"
        data-sizes="auto"
        alt="assets/446c96dd365c49dc89ccb67a87dcdb2b.png"
        title="assets/446c96dd365c49dc89ccb67a87dcdb2b.png" /></p>
<h3 id="16-spingboot多环境开发">1.6 SpingBoot多环境开发</h3>
<h4 id="161-分文件的多环境开发">1.6.1 分文件的多环境开发</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>StringBoot的配置文件命名规则：
</span></span><span style="display:flex;"><span>	application-xx.properties/yaml/yml
</span></span><span style="display:flex;"><span>在开发中我们通常会根据不同的场景创建不同名字的配置文件
</span></span><span style="display:flex;"><span>	application-dev.yaml #用于开发阶段的配置文件
</span></span><span style="display:flex;"><span>	application-test.yaml #用于测试阶段的配置文件
</span></span><span style="display:flex;"><span>	application-pro.yaml #用于上线阶段的配置文件
</span></span><span style="display:flex;"><span>在主配置文件中激活生效的配置文件
</span></span><span style="display:flex;"><span>#启动指定环境
</span></span><span style="display:flex;"><span>    spring:
</span></span><span style="display:flex;"><span>      profiles:
</span></span><span style="display:flex;"><span>        active: dev	
</span></span></code></pre></div><h4 id="162-不分文件的多环境开发">1.6.2 不分文件的多环境开发</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span>application<span style="color:#f92672">.</span><span style="color:#a6e22e">yaml</span><span style="color:#960050;background-color:#1e0010">配置文件</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#启动指定环境</span>
</span></span><span style="display:flex;"><span>spring:
</span></span><span style="display:flex;"><span>  profiles<span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>    active<span style="color:#f92672">:</span> dev
</span></span><span style="display:flex;"><span><span style="color:#f92672">---</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#设置生产环境</span>
</span></span><span style="display:flex;"><span>spring:
</span></span><span style="display:flex;"><span>  profiles<span style="color:#f92672">:</span> pro
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>server:
</span></span><span style="display:flex;"><span>  port<span style="color:#f92672">:</span> <span style="color:#ae81ff">88</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">---</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#设置开发环境</span>
</span></span><span style="display:flex;"><span>spring:
</span></span><span style="display:flex;"><span>  profiles<span style="color:#f92672">:</span> dev
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>server:
</span></span><span style="display:flex;"><span>  port<span style="color:#f92672">:</span> <span style="color:#ae81ff">89</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">---</span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#设置测试环境</span>
</span></span><span style="display:flex;"><span>spring:
</span></span><span style="display:flex;"><span>  profiles<span style="color:#f92672">:</span> test
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>server:
</span></span><span style="display:flex;"><span>  port<span style="color:#f92672">:</span> <span style="color:#ae81ff">90</span>
</span></span></code></pre></div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets%5c1682386191547.png"
        data-srcset="assets%5c1682386191547.png, assets%5c1682386191547.png 1.5x, assets%5c1682386191547.png 2x"
        data-sizes="auto"
        alt="assets\1682386191547.png"
        title="1682386191547" /></p>
<h1 id="二-springboot工作原理面试">二 SpringBoot工作原理【面试】</h1>
<p>思考一个问题：</p>
<p>为什么加载了redis的starter之后，RedisTemplate对象会自动被new出来，可以@Autowired了呢？</p>
<h2 id="21-自动装配">2.1 自动装配</h2>
<p>观察<code>@EnableAutoConfiguration</code> 注解内部使用 <code>@Import(AutoConfigurationImportSelector.class)</code>读取<code>META-INF/spring.factories</code>，</p>
<p>该配置文件中定义了大量的配置类，当 SpringBoot 应用启动时，会自动加载这些配置类，初始化Bean</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/image-20201211100741504.png"
        data-srcset="assets/image-20201211100741504.png, assets/image-20201211100741504.png 1.5x, assets/image-20201211100741504.png 2x"
        data-sizes="auto"
        alt="assets/image-20201211100741504.png"
        title="image-20201211100741504" /></p>
<p>由于SpringBoot启动是会读取@SpringBootApplication注解</p>
<p>而@SpringBootApplication包含了@EnableAutoConfiguration</p>
<p>而@EnableAutoConfiguration注解引入AutoConfigurationImportSelector.class</p>
<p>而AutoConfigurationImportSelector.class中有一个方法getCandidateConfigurations</p>
<p>而getCandidateConfigurations方法读取META-INF/spring.factories</p>
<p>所以我们只需要将自动配置类配置到我们项目的META-INF/spring.factories文件中即可</p>
<h2 id="22-装配redis">2.2 装配Redis</h2>
<p>并不是读取<code>META-INF/spring.factories</code>所有的Bean都会被初始化，在配置类中使用<code>@Condition</code>来加载满足条件的Bean</p>
<ul>
<li>ConditionalOnClass：判断环境中是否有对应字节码文件才初始化Bean</li>
<li>ConditionalOnBean：判断容器中是否有对应Bean对象才初始化Bean</li>
<li>ConditionalOnMissingClass：判断环境中没有对应字节码才初始化Bean</li>
<li>ConditionalOnMissingBean：判断环境中没有对应Bean才初始化Bean</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/image-20201211102147101.png"
        data-srcset="assets/image-20201211102147101.png, assets/image-20201211102147101.png 1.5x, assets/image-20201211102147101.png 2x"
        data-sizes="auto"
        alt="assets/image-20201211102147101.png"
        title="image-20201211102147101" /></p>
<h2 id="23-知识小结">2.3 知识小结</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/image-20201211102826437.png"
        data-srcset="assets/image-20201211102826437.png, assets/image-20201211102826437.png 1.5x, assets/image-20201211102826437.png 2x"
        data-sizes="auto"
        alt="assets/image-20201211102826437.png"
        title="image-20201211102826437" /></p>
<h1 id="三-自定义启动器大作业">三 自定义启动器【大作业】</h1>
<p>有了上面的一些知识点，我们可以自定义一个Redis的启动器 redis-spring-boot-starter`</p>
<p>我们可参考MybatisPlus的启动器，因为MybatisPlus是第三方的（不是spring提供的）</p>
<blockquote>
<p>效果：在工程中只需要导入起步依赖，通过@Autowired注入</p>
</blockquote>
<h2 id="31-分析mybatisplus启动器">3.1 分析MybatisPlus启动器</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/image-20201211105455389.png"
        data-srcset="assets/image-20201211105455389.png, assets/image-20201211105455389.png 1.5x, assets/image-20201211105455389.png 2x"
        data-sizes="auto"
        alt="assets/image-20201211105455389.png"
        title="image-20201211105455389" /></p>
<h2 id="32-代码实现">3.2 代码实现</h2>
<blockquote>
<p>xxxx-spring-boot-starter</p>
</blockquote>
<h4 id="-导入依赖-1">① 导入依赖</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;project</span> <span style="color:#a6e22e">xmlns=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0&#34;</span> <span style="color:#a6e22e">xmlns:xsi=</span><span style="color:#e6db74">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">xsi:schemaLocation=</span><span style="color:#e6db74">&#34;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;modelVersion&gt;</span>4.0.0<span style="color:#f92672">&lt;/modelVersion&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;parent&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-parent<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;version&gt;</span>2.7.11<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;/parent&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;dependencies&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-starter-test<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;groupId&gt;</span>org.projectlombok<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;artifactId&gt;</span>lombok<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-configuration-processor<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;groupId&gt;</span>redis.clients<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#f92672">&lt;artifactId&gt;</span>jedis<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">&lt;/dependencies&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/project&gt;</span>
</span></span></code></pre></div><h4 id="-编写jedisproperties">② 编写JedisProperties</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Data</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@ConfigurationProperties</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;my.redis&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">JedisProperties</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String host<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> port<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h4 id="-编写自动装配类">③ 编写自动装配类</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyRedisConfig</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> JedisProperties properties<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@ConditionalOnMissingBean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Jedis <span style="color:#a6e22e">jedis</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>        Jedis jedis <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Jedis<span style="color:#f92672">(</span>properties<span style="color:#f92672">.</span><span style="color:#a6e22e">getHost</span><span style="color:#f92672">(),</span>properties<span style="color:#f92672">.</span><span style="color:#a6e22e">getPort</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> jedis<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h4 id="编写自动装配文件">④编写自动装配文件</h4>
<blockquote>
<p>/META-INF/spring.factories</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-properties" data-lang="properties"><span style="display:flex;"><span><span style="color:#a6e22e">org.springframework.boot.autoconfigure.EnableAutoConfiguration</span><span style="color:#f92672">=</span><span style="color:#e6db74">\
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">com.zhyp.redisspringbootstarter.config.MyRedisConfig</span>
</span></span></code></pre></div><h4 id="测试类中测试一下">⑤测试类中测试一下</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@SpringBootTest</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TestDemo</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Jedis jedis<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>jedis<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h2 id="33-引入测试">3.3 引入测试</h2>
<h4 id="安装reids-spring-boot-starter到maven仓库中">①安装Reids-spring-boot-starter到maven仓库中</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets%5c1682247410938.png"
        data-srcset="assets%5c1682247410938.png, assets%5c1682247410938.png 1.5x, assets%5c1682247410938.png 2x"
        data-sizes="auto"
        alt="assets\1682247410938.png"
        title="1682247410938" /></p>
<h4 id="在其他项目中引入reids-spring-boot-starter的起步依赖">②在其他项目中引入Reids-spring-boot-starter的起步依赖</h4>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/image-20201211112106099.png"
        data-srcset="assets/image-20201211112106099.png, assets/image-20201211112106099.png 1.5x, assets/image-20201211112106099.png 2x"
        data-sizes="auto"
        alt="assets/image-20201211112106099.png"
        title="image-20201211112106099" /></p>
<h4 id="-编写配置文件">③ 编写配置文件</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">my</span>: 
</span></span><span style="display:flex;"><span> <span style="color:#f92672">redis</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">host</span>: <span style="color:#ae81ff">localhost</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">port</span>: <span style="color:#ae81ff">6379</span>
</span></span></code></pre></div><h4 id="--启动项目访问测试">④  启动项目访问测试</h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Controller</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyController</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Jedis jedis<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@RequestMapping</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;/redis&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@ResponseBody</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">redis</span><span style="color:#f92672">(){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> jedis<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h1 id="四-springboot项目部署和其他">四 SpringBoot项目部署和其他</h1>
<h2 id="41-jar包发布官方推荐">4.1 jar包发布（官方推荐）</h2>
<h3 id="411-配置打包插件">4.1.1 配置打包插件</h3>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/image-20201211113957025.png"
        data-srcset="assets/image-20201211113957025.png, assets/image-20201211113957025.png 1.5x, assets/image-20201211113957025.png 2x"
        data-sizes="auto"
        alt="assets/image-20201211113957025.png"
        title="image-20201211113957025" /></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;build&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;finalName&gt;</span>zhyp<span style="color:#f92672">&lt;/finalName&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;plugins&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;plugin&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/plugin&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/plugins&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/build&gt;</span>
</span></span></code></pre></div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/image-20201211113933417.png"
        data-srcset="assets/image-20201211113933417.png, assets/image-20201211113933417.png 1.5x, assets/image-20201211113933417.png 2x"
        data-sizes="auto"
        alt="assets/image-20201211113933417.png"
        title="image-20201211113933417" /></p>
<h3 id="412-执行java命令">4.1.2 执行java命令</h3>
<blockquote>
<p>通过maven命令package完成项目打包；找到jar包位置，以命令行窗口执行</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>java -jar xxx.jar 
</span></span></code></pre></div><h2 id="42-war包发布了解">4.2 war包发布（了解）</h2>
<h3 id="421-项目打包方式">4.2.1 项目打包方式</h3>
<blockquote>
<p>找到项目的pom.xml文件修改默认打包方式为war</p>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/image-20201211114252941.png"
        data-srcset="assets/image-20201211114252941.png, assets/image-20201211114252941.png 1.5x, assets/image-20201211114252941.png 2x"
        data-sizes="auto"
        alt="assets/image-20201211114252941.png"
        title="image-20201211114252941" /></p>
<h3 id="422-配置启动类">4.2.2 配置启动类</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@SpringBootApplication</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@MapperScan</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;com.itheima.mapper&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ThymeleafApp</span>  <span style="color:#66d9ef">extends</span> SpringBootServletInitializer <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        SpringApplication<span style="color:#f92672">.</span><span style="color:#a6e22e">run</span><span style="color:#f92672">(</span>ThymeleafApp<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">,</span> args<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> SpringApplicationBuilder <span style="color:#a6e22e">configure</span><span style="color:#f92672">(</span>SpringApplicationBuilder builder<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> builder<span style="color:#f92672">.</span><span style="color:#a6e22e">sources</span><span style="color:#f92672">(</span>ThymeleafApp<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><h3 id="423-部署到tomcat">4.2.3 部署到Tomcat</h3>
<p>执行maven的package命令，将打好的war包放入Tomcat中运行即可</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/image-20201211113933417.png"
        data-srcset="assets/image-20201211113933417.png, assets/image-20201211113933417.png 1.5x, assets/image-20201211113933417.png 2x"
        data-sizes="auto"
        alt="assets/image-20201211113933417.png"
        title="image-20201211113933417" /></p>
<h2 id="43-自定义彩蛋">4.3 自定义彩蛋</h2>
<ul>
<li>网址: <a href="http://www.patorjk.com/software/taag/" target="_blank" rel="noopener noreffer ">http://www.patorjk.com/software/taag/</a></li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets/image-20201211115110906.png"
        data-srcset="assets/image-20201211115110906.png, assets/image-20201211115110906.png 1.5x, assets/image-20201211115110906.png 2x"
        data-sizes="auto"
        alt="assets/image-20201211115110906.png"
        title="image-20201211115110906" /></p>
<h2 id="44-通过添加parent引入stringboot">4.4 通过添加<!-- raw HTML omitted -->引入StringBoot</h2>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets%5c1682252423052.png"
        data-srcset="assets%5c1682252423052.png, assets%5c1682252423052.png 1.5x, assets%5c1682252423052.png 2x"
        data-sizes="auto"
        alt="assets\1682252423052.png"
        title="1682252423052" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="assets%5c1682252568483.png"
        data-srcset="assets%5c1682252568483.png, assets%5c1682252568483.png 1.5x, assets%5c1682252568483.png 2x"
        data-sizes="auto"
        alt="assets\1682252568483.png"
        title="1682252568483" /></p>
<h2 id="45-springboot热部署">4.5 SpringBoot热部署</h2>
<p>在开发过程中，通常会对一段业务代码不断地修改测试，在修改之后往往需要重启服务，有些服务需要加载很久才能启动成功，这种不必要的重复操作极大的降低了程序开发效率。为此，Spring Boot框架专门提供了进行热部署的依赖启动器，用于进行项目热部署，而无需手动重启项目</p>
<blockquote>
<ol>
<li>pom.xml</li>
</ol>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- 引入热部署依赖 --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&lt;artifactId&gt;</span>spring-boot-devtools<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span></code></pre></div><blockquote>
<ol>
<li>选择IDEA工具界面的【File】-&gt;【Settings】选项，打开Compiler面板设置页面</li>
</ol>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="E:/%E7%91%9E%E9%80%9A/1.springboot%285d%29/assets/image-20201021153404533.png"
        data-srcset="E:/%E7%91%9E%E9%80%9A/1.springboot%285d%29/assets/image-20201021153404533.png, E:/%E7%91%9E%E9%80%9A/1.springboot%285d%29/assets/image-20201021153404533.png 1.5x, E:/%E7%91%9E%E9%80%9A/1.springboot%285d%29/assets/image-20201021153404533.png 2x"
        data-sizes="auto"
        alt="E:/%E7%91%9E%E9%80%9A/1.springboot(5d)/assets/image-20201021153404533.png"
        title="image-20201021153404533" /></p>
<blockquote>
<ol>
<li>在项目任意页面中使用组合快捷键“Ctrl+Shift+Alt+/”打开Maintenance选项框，选中并打开Registry</li>
</ol>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="E:/%E7%91%9E%E9%80%9A/1.springboot%285d%29/assets/image-20201021153531251.png"
        data-srcset="E:/%E7%91%9E%E9%80%9A/1.springboot%285d%29/assets/image-20201021153531251.png, E:/%E7%91%9E%E9%80%9A/1.springboot%285d%29/assets/image-20201021153531251.png 1.5x, E:/%E7%91%9E%E9%80%9A/1.springboot%285d%29/assets/image-20201021153531251.png 2x"
        data-sizes="auto"
        alt="E:/%E7%91%9E%E9%80%9A/1.springboot(5d)/assets/image-20201021153531251.png"
        title="image-20201021153531251" /></p>
<blockquote>
<ol>
<li>找到“compiler.automake.allow.when.app.running”，将该选项后的Value值勾选</li>
</ol>
</blockquote>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="E:/%E7%91%9E%E9%80%9A/1.springboot%285d%29/assets/image-20201021153641871.png"
        data-srcset="E:/%E7%91%9E%E9%80%9A/1.springboot%285d%29/assets/image-20201021153641871.png, E:/%E7%91%9E%E9%80%9A/1.springboot%285d%29/assets/image-20201021153641871.png 1.5x, E:/%E7%91%9E%E9%80%9A/1.springboot%285d%29/assets/image-20201021153641871.png 2x"
        data-sizes="auto"
        alt="E:/%E7%91%9E%E9%80%9A/1.springboot(5d)/assets/image-20201021153641871.png"
        title="image-20201021153641871" /></p>
<h1 id="五-课堂作业">五 课堂作业</h1>
<ol>
<li>
<p>springboot+thymeleaf/FreeMarker+mybatisPlus，完成用户列表的查询</p>
</li>
<li>
<p>整合redis，实现用户列表的缓存</p>
</li>
<li>
<p>理解自动装配,完成自动装配</p>
<p>（导入xxx启动依赖，就可以@autowired完成注入）</p>
</li>
</ol>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-07-29</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://cheneycqg.github.io/posts/springboot%E8%BF%9B%E9%98%B6%E7%AF%87/" data-title="Test"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://cheneycqg.github.io/posts/springboot%E8%BF%9B%E9%98%B6%E7%AF%87/"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://cheneycqg.github.io/posts/springboot%E8%BF%9B%E9%98%B6%E7%AF%87/" data-title="Test"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://cheneycqg.github.io/posts/springboot%E8%BF%9B%E9%98%B6%E7%AF%87/" data-title="Test"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://cheneycqg.github.io/posts/springboot%E8%BF%9B%E9%98%B6%E7%AF%87/" data-title="Test"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/cyq/" class="prev" rel="prev" title="陈雨琪！！我爱你"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>陈雨琪！！我爱你</a>
            <a href="/posts/test/" class="next" rel="next" title="test">test<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.114.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank"></a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
